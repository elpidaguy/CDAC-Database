1.Write a query in SQL to display all the information of the employees

mysql> select *
    -> from emp;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

2.Write a query in SQL to find the salaries of all employees.

mysql> select ename, sal
    -> from emp;
+--------+---------+
| ename  | sal     |
+--------+---------+
| SMITH  |  800.00 |
| ALLEN  | 1600.00 |
| WARD   | 1250.00 |
| JONES  | 2975.00 |
| MARTIN | 1250.00 |
| BLAKE  | 2850.00 |
| CLARK  | 2450.00 |
| SCOTT  | 3000.00 |
| KING   | 5000.00 |
| TURNER | 1500.00 |
| ADAMS  | 1100.00 |
| JAMES  |  950.00 |
| FORD   | 3000.00 |
| MILLER | 1300.00 |
+--------+---------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

3.Write a query in SQL to display the unique designations for the
employees.

mysql> select distinct job
    -> from emp;
+-----------+
| job       |
+-----------+
| CLERK     |
| SALESMAN  |
| MANAGER   |
| ANALYST   |
| PRESIDENT |
+-----------+
5 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

4.Write a query in SQL to list the emp_name and salary is increased by 15%
and expressed as no.of Dollars.

mysql> select ename Name,sal Salary,concat(round((sal+sal*0.15),2),'$') "Increased Salary"
    -> from emp;
+--------+---------+------------------+
| Name   | Salary  | Increased Salary |
+--------+---------+------------------+
| SMITH  |  800.00 | 920.00$          |
| ALLEN  | 1600.00 | 1840.00$         |
| WARD   | 1250.00 | 1437.50$         |
| JONES  | 2975.00 | 3421.25$         |
| MARTIN | 1250.00 | 1437.50$         |
| BLAKE  | 2850.00 | 3277.50$         |
| CLARK  | 2450.00 | 2817.50$         |
| SCOTT  | 3000.00 | 3450.00$         |
| KING   | 5000.00 | 5750.00$         |
| TURNER | 1500.00 | 1725.00$         |
| ADAMS  | 1100.00 | 1265.00$         |
| JAMES  |  950.00 | 1092.50$         |
| FORD   | 3000.00 | 3450.00$         |
| MILLER | 1300.00 | 1495.00$         |
+--------+---------+------------------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

5.Write a query in SQL to produce the output of employees name and job
name as a fromat of "Employee & Job".

mysql> select concat(ename,' & ',job) as 'Employee & Job'
    -> from emp;
+-------------------+
| Employee & Job    |
+-------------------+
| SMITH & CLERK     |
| ALLEN & SALESMAN  |
| WARD & SALESMAN   |
| JONES & MANAGER   |
| MARTIN & SALESMAN |
| BLAKE & MANAGER   |
| CLARK & MANAGER   |
| SCOTT & ANALYST   |
| KING & PRESIDENT  |
| TURNER & SALESMAN |
| ADAMS & CLERK     |
| JAMES & CLERK     |
| FORD & ANALYST    |
| MILLER & CLERK    |
+-------------------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

6.Write a query in SQL to produce the output of employees as follows:
Employee
JONAS(manager).

mysql> select concat(ename,'(',job,')') as "Employee"
    -> from emp;
+------------------+
| Employee         |
+------------------+
| SMITH(CLERK)     |
| ALLEN(SALESMAN)  |
| WARD(SALESMAN)   |
| JONES(MANAGER)   |
| MARTIN(SALESMAN) |
| BLAKE(MANAGER)   |
| CLARK(MANAGER)   |
| SCOTT(ANALYST)   |
| KING(PRESIDENT)  |
| TURNER(SALESMAN) |
| ADAMS(CLERK)     |
| JAMES(CLERK)     |
| FORD(ANALYST)    |
| MILLER(CLERK)    |
+------------------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

7.Write a query in SQL to list the employees with Hire date in the format like
February 22, 1991.

mysql> select date_format(hiredate,'%M %d,%Y')
    -> from emp;
+----------------------------------+
| date_format(hiredate,'%M %d,%Y') |
+----------------------------------+
| December 17,1980                 |
| February 20,1981                 |
| February 22,1981                 |
| April 02,1981                    |
| September 28,1981                |
| May 01,1981                      |
| June 09,1981                     |
| December 09,1982                 |
| November 17,1981                 |
| September 08,1981                |
| January 12,1983                  |
| December 03,1981                 |
| December 03,1981                 |
| January 23,1982                  |
+----------------------------------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

8.Write a query in SQL to count the no. of characters with out considering the
spaces for each name.

mysql> select ename,length(trim(ename))
    -> from emp;
+--------+---------------------+
| ename  | length(trim(ename)) |
+--------+---------------------+
| SMITH  |                   5 |
| ALLEN  |                   5 |
| WARD   |                   4 |
| JONES  |                   5 |
| MARTIN |                   6 |
| BLAKE  |                   5 |
| CLARK  |                   5 |
| SCOTT  |                   5 |
| KING   |                   4 |
| TURNER |                   6 |
| ADAMS  |                   5 |
| JAMES  |                   5 |
| FORD   |                   4 |
| MILLER |                   6 |
+--------+---------------------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

9.Write a query in SQL to list the emp_id,salary, and commission of all the
employees.

mysql> select empno,sal,comm
    -> from emp
    -> ;
+-------+---------+---------+
| empno | sal     | comm    |
+-------+---------+---------+
|  7369 |  800.00 |    NULL |
|  7499 | 1600.00 |  300.00 |
|  7521 | 1250.00 |  500.00 |
|  7566 | 2975.00 |    NULL |
|  7654 | 1250.00 | 1400.00 |
|  7698 | 2850.00 |    NULL |
|  7782 | 2450.00 |    NULL |
|  7788 | 3000.00 |    NULL |
|  7839 | 5000.00 |    NULL |
|  7844 | 1500.00 |    0.00 |
|  7876 | 1100.00 |    NULL |
|  7900 |  950.00 |    NULL |
|  7902 | 3000.00 |    NULL |
|  7934 | 1300.00 |    NULL |
+-------+---------+---------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

10.Write a query in SQL to display the unique department with jobs.

mysql> select distinct deptno,job
    -> from emp;
+--------+-----------+
| deptno | job       |
+--------+-----------+
|     20 | CLERK     |
|     30 | SALESMAN  |
|     20 | MANAGER   |
|     30 | MANAGER   |
|     10 | MANAGER   |
|     20 | ANALYST   |
|     10 | PRESIDENT |
|     30 | CLERK     |
|     10 | CLERK     |
+--------+-----------+
9 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

11.Write a query in SQL to list the employees who does not belong to
department 2001.

mysql> select *
    -> from emp
    -> where deptno != 2001;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

mysql> select *
    -> from emp
    -> where deptno not in(2001);
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

12.Write a query in SQL to list the employees who joined before 1991.

mysql> select *
    -> from emp
    -> where year(hiredate) < 1991;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

mysql> select *
    -> from emp
    -> where year(hiredate) < 1981;
+-------+-------+-------+------+------------+--------+------+--------+
| EMPNO | ENAME | JOB   | MGR  | HIREDATE   | SAL    | COMM | DEPTNO |
+-------+-------+-------+------+------------+--------+------+--------+
|  7369 | SMITH | CLERK | 7902 | 1980-12-17 | 800.00 | NULL |     20 |
+-------+-------+-------+------+------------+--------+------+--------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

13.Write a query in SQL to display the average salaries of all the employees
who works as ANALYST.

mysql> select ename,sal,round(avg(sal),2) as "Average Sal",job
    -> from emp
    -> where job="analyst";
+-------+---------+-------------+---------+
| ename | sal     | Average Sal | job     |
+-------+---------+-------------+---------+
| SCOTT | 3000.00 |     3000.00 | ANALYST |
+-------+---------+-------------+---------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

14.Write a query in SQL to display the details of the employee BLAZE.

mysql> select *
    -> from emp
    -> where ename LIKE('BLAZE');
Empty set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

15.Write a query in SQL to display all the details of the employees whose
commission is more than their salary.

mysql> select *
    -> from emp
    -> where comm>sal;
+-------+--------+----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+----------+------+------------+---------+---------+--------+
|  7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
+-------+--------+----------+------+------------+---------+---------+--------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

16.Write a query in SQL to list the employees whose salary is more than
3000 after giving 25% increment.

mysql> select ename,sal,ceil((sal+sal*0.25)) "25% INC"
    -> from emp
    -> where (sal+sal*0.25) > 3000;
+-------+---------+---------+
| ename | sal     | 25% INC |
+-------+---------+---------+
| JONES | 2975.00 |    3719 |
| BLAKE | 2850.00 |    3563 |
| CLARK | 2450.00 |    3063 |
| SCOTT | 3000.00 |    3750 |
| KING  | 5000.00 |    6250 |
| FORD  | 3000.00 |    3750 |
+-------+---------+---------+
6 rows in set (0.00 sec)

17.Write a query in SQL to list the name of the employees, those having six
characters to their name.

------------------------------------------------------------------------------------------------------------------------------

18.Write a query in SQL to list the employees who joined in the month
January.

mysql> select ename, hiredate
    -> from emp
    -> where month(hiredate) = 1;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| ADAMS  | 1983-01-12 |
| MILLER | 1982-01-23 |
+--------+------------+
2 rows in set (0.00 sec)

mysql> select ename, hiredate
    -> from emp
    -> where monthname(hiredate) = "january";
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| ADAMS  | 1983-01-12 |
| MILLER | 1982-01-23 |
+--------+------------+
2 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

19.Write a query in SQL to list the name of employees and their manager
separated by the string 'works for'.

mysql> select ename,mgr as manager,(select ename from emp where empno = manager), concat(ename,' works for ', (select ename from emp where empno = manager))
    -> from emp
    -> ;
+--------+---------+-----------------------------------------------+----------------------------------------------------------------------------+
| ename  | manager | (select ename from emp where empno = manager) | concat(ename,' works for ', (select ename from emp where empno = manager)) |
+--------+---------+-----------------------------------------------+----------------------------------------------------------------------------+
| SMITH  |    7902 | FORD                                          | SMITH works for FORD                                                       |
| ALLEN  |    7698 | BLAKE                                         | ALLEN works for BLAKE                                                      |
| WARD   |    7698 | BLAKE                                         | WARD works for BLAKE                                                       |
| JONES  |    7839 | KING                                          | JONES works for KING                                                       |
| MARTIN |    7698 | BLAKE                                         | MARTIN works for BLAKE                                                     |
| BLAKE  |    7839 | KING                                          | BLAKE works for KING                                                       |
| CLARK  |    7839 | KING                                          | CLARK works for KING                                                       |
| SCOTT  |    7566 | JONES                                         | SCOTT works for JONES                                                      |
| KING   |    NULL | NULL                                          | NULL                                                                       |
| TURNER |    7698 | BLAKE                                         | TURNER works for BLAKE                                                     |
| ADAMS  |    7788 | SCOTT                                         | ADAMS works for SCOTT                                                      |
| JAMES  |    7698 | BLAKE                                         | JAMES works for BLAKE                                                      |
| FORD   |    7566 | JONES                                         | FORD works for JONES                                                       |
| MILLER |    7782 | CLARK                                         | MILLER works for CLARK                                                     |
+--------+---------+-----------------------------------------------+----------------------------------------------------------------------------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

20.Write a query in SQL to list all the employees whose designation is
CLERK.

mysql> select ename, job
    -> from emp
    -> where job = 'clerk';
+--------+-------+
| ename  | job   |
+--------+-------+
| SMITH  | CLERK |
| ADAMS  | CLERK |
| JAMES  | CLERK |
| MILLER | CLERK |
+--------+-------+
4 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

21.Write a query in SQL to list the employees whose experience is more than
10 years.

mysql> select ename, hiredate, floor(datediff(curdate(),hiredate)/365) as "XP"
    -> from emp
    -> where floor(datediff(curdate(),hiredate)/365) > 10;
+--------+------------+------+
| ename  | hiredate   | XP   |
+--------+------------+------+
| SMITH  | 1980-12-17 |   38 |
| ALLEN  | 1981-02-20 |   38 |
| WARD   | 1981-02-22 |   38 |
| JONES  | 1981-04-02 |   38 |
| MARTIN | 1981-09-28 |   38 |
| BLAKE  | 1981-05-01 |   38 |
| CLARK  | 1981-06-09 |   38 |
| SCOTT  | 1982-12-09 |   36 |
| KING   | 1981-11-17 |   37 |
| TURNER | 1981-09-08 |   38 |
| ADAMS  | 1983-01-12 |   36 |
| JAMES  | 1981-12-03 |   37 |
| FORD   | 1981-12-03 |   37 |
| MILLER | 1982-01-23 |   37 |
+--------+------------+------+
14 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

22.Write a query in SQL to list the employees whose salaries are less than
3500.

mysql> select ename, sal
    -> from emp
    -> where sal < 3500
    -> order by ename;
+--------+---------+
| ename  | sal     |
+--------+---------+
| ADAMS  | 1100.00 |
| ALLEN  | 1600.00 |
| BLAKE  | 2850.00 |
| CLARK  | 2450.00 |
| FORD   | 3000.00 |
| JAMES  |  950.00 |
| JONES  | 2975.00 |
| MARTIN | 1250.00 |
| MILLER | 1300.00 |
| SCOTT  | 3000.00 |
| SMITH  |  800.00 |
| TURNER | 1500.00 |
| WARD   | 1250.00 |
+--------+---------+
13 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

23.Write a query in SQL to list the name, job_name, and salary of any
employee whose designation is ANALYST.

mysql> select ename,job,sal
    -> from emp
    -> where job='analyst';
+-------+---------+---------+
| ename | job     | sal     |
+-------+---------+---------+
| SCOTT | ANALYST | 3000.00 |
| FORD  | ANALYST | 3000.00 |
+-------+---------+---------+
2 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

24.Write a query in SQL to list the employees who have joined in the year
1991.

mysql> select ename,hiredate
    -> from emp
    -> where year(hiredate) = 1991;
Empty set (0.00 sec)

mysql> select ename,hiredate
    -> from emp
    -> where year(hiredate) = 1981;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| ALLEN  | 1981-02-20 |
| WARD   | 1981-02-22 |
| JONES  | 1981-04-02 |
| MARTIN | 1981-09-28 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
+--------+------------+
10 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

25.Write a query in SQL to list the name, id, hire_date, and salary of all the
employees joined before 1 apr 91.

mysql> select ename,empno,hiredate,sal
    -> from emp
    -> where hiredate < str_to_date('01 apr 81','%d %M %y');
+-------+-------+------------+---------+
| ename | empno | hiredate   | sal     |
+-------+-------+------------+---------+
| SMITH |  7369 | 1980-12-17 |  800.00 |
| ALLEN |  7499 | 1981-02-20 | 1600.00 |
| WARD  |  7521 | 1981-02-22 | 1250.00 |
+-------+-------+------------+---------+
3 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

26.Write a query in SQL to list the employee name, and job_name who are
not working under a manager.

mysql> select ename, job
    -> from  emp
    -> where mgr is null;
+-------+-----------+
| ename | job       |
+-------+-----------+
| KING  | PRESIDENT |
+-------+-----------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

27.Write a query in SQL to list all the employees joined on 1st may 81.

mysql> select ename,hiredate
    -> from emp
    -> where hiredate = str_to_date('1st may 81','%D %M %Y');
+-------+------------+
| ename | hiredate   |
+-------+------------+
| BLAKE | 1981-05-01 |
+-------+------------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

28.Write a query in SQL to list the id, name, salry, and experiences of all the
employees working for the manger 7839.

mysql> select empno,ename,sal, floor(datediff(curdate(),hiredate)/365) as "XP"
    -> from emp
    -> where mgr = 7839;
+-------+-------+---------+------+
| empno | ename | sal     | XP   |
+-------+-------+---------+------+
|  7566 | JONES | 2975.00 |   38 |
|  7698 | BLAKE | 2850.00 |   38 |
|  7782 | CLARK | 2450.00 |   38 |
+-------+-------+---------+------+
3 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

29.Write a query in SQL to list the id, name, salary, and experience of all the
employees who earn more than 100 as daily salary.

mysql> select empno,ename,sal, floor(datediff(curdate(),hiredate)/365) as "XP"
    -> from emp
    -> where sal/31 > 100;
+-------+-------+---------+------+
| empno | ename | sal     | XP   |
+-------+-------+---------+------+
|  7839 | KING  | 5000.00 |   37 |
+-------+-------+---------+------+
1 row in set (0.00 sec)


------------------------------------------------------------------------------------------------------------------------------

30.Write a query in SQL to list the employees who are retiring after 31-Dec-
99 after completion of 8 years of service period.

mysql> select ename, hiredate, floor(datediff(curdate(),hiredate)/365) as "XP"
    -> from emp
    -> where floor(datediff(str_to_date('31-Dec-99', '%d-%M-%Y'),hiredate)/365) > 8;
+--------+------------+------+
| ename  | hiredate   | XP   |
+--------+------------+------+
| SMITH  | 1980-12-17 |   38 |
| ALLEN  | 1981-02-20 |   38 |
| WARD   | 1981-02-22 |   38 |
| JONES  | 1981-04-02 |   38 |
| MARTIN | 1981-09-28 |   38 |
| BLAKE  | 1981-05-01 |   38 |
| CLARK  | 1981-06-09 |   38 |
| SCOTT  | 1982-12-09 |   36 |
| KING   | 1981-11-17 |   37 |
| TURNER | 1981-09-08 |   38 |
| ADAMS  | 1983-01-12 |   36 |
| JAMES  | 1981-12-03 |   37 |
| FORD   | 1981-12-03 |   37 |
| MILLER | 1982-01-23 |   37 |
+--------+------------+------+
14 rows in set (0.00 sec)


mysql> select ename, hiredate, floor(datediff(curdate(),hiredate)/365) as "XP"
    -> from emp
    -> where floor(datediff(str_to_date('31-Dec-99', '%d-%M-%Y'),hiredate)/365) > 18;
+-------+------------+------+
| ename | hiredate   | XP   |
+-------+------------+------+
| SMITH | 1980-12-17 |   38 |
+-------+------------+------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

31.Write a query in SQL to list those employees whose salary is an odd
value.

mysql> select ename, sal
    -> from emp
    -> where sal%2 = 0;
+--------+---------+
| ename  | sal     |
+--------+---------+
| SMITH  |  800.00 |
| ALLEN  | 1600.00 |
| WARD   | 1250.00 |
| MARTIN | 1250.00 |
| BLAKE  | 2850.00 |
| CLARK  | 2450.00 |
| SCOTT  | 3000.00 |
| KING   | 5000.00 |
| TURNER | 1500.00 |
| ADAMS  | 1100.00 |
| JAMES  |  950.00 |
| FORD   | 3000.00 |
| MILLER | 1300.00 |
+--------+---------+
13 rows in set (0.00 sec)

mysql> select ename, sal
    -> from emp
    -> where sal%2 != 0;
+-------+---------+
| ename | sal     |
+-------+---------+
| JONES | 2975.00 |
+-------+---------+
1 row in set (0.00 sec)

mysql> select ename, sal
    -> from emp
    -> where mod(sal,2) = 0;
+--------+---------+
| ename  | sal     |
+--------+---------+
| SMITH  |  800.00 |
| ALLEN  | 1600.00 |
| WARD   | 1250.00 |
| MARTIN | 1250.00 |
| BLAKE  | 2850.00 |
| CLARK  | 2450.00 |
| SCOTT  | 3000.00 |
| KING   | 5000.00 |
| TURNER | 1500.00 |
| ADAMS  | 1100.00 |
| JAMES  |  950.00 |
| FORD   | 3000.00 |
| MILLER | 1300.00 |
+--------+---------+
13 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

32.Write a query in SQL to list those employees whose salary contain only 3
digits.

mysql> select ename, sal
    -> from emp
    -> where length(ceil(sal)) = 3;
+-------+--------+
| ename | sal    |
+-------+--------+
| SMITH | 800.00 |
| JAMES | 950.00 |
+-------+--------+
2 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

33.Write a query in SQL to list the employees who joined in the month of
APRIL.

mysql> select ename, hiredate
    -> from emp
    -> where monthname(hiredate) = 'april';
+-------+------------+
| ename | hiredate   |
+-------+------------+
| JONES | 1981-04-02 |
+-------+------------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

34.Write a query in SQL to list the employees those who joined in company
before 19th of the month.

mysql> select ename, hiredate
    -> from emp
    -> where day(hiredate) < 19;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| SMITH  | 1980-12-17 |
| JONES  | 1981-04-02 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| SCOTT  | 1982-12-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| ADAMS  | 1983-01-12 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
+--------+------------+
10 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

35.Write a query in SQL to list the employees who are SALESMAN and
gathered an experience over 10 years.

mysql> select ename, job, hiredate, floor(datediff(curdate(),hiredate)/365) as "XP"
    -> from emp
    -> where job = 'salesman' and floor(datediff(curdate(),hiredate)/365) > 10;
+--------+----------+------------+------+
| ename  | job      | hiredate   | XP   |
+--------+----------+------------+------+
| ALLEN  | SALESMAN | 1981-02-20 |   38 |
| WARD   | SALESMAN | 1981-02-22 |   38 |
| MARTIN | SALESMAN | 1981-09-28 |   38 |
| TURNER | SALESMAN | 1981-09-08 |   38 |
+--------+----------+------------+------+
4 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

36.Write a query in SQL to list the employees of department id 3001 or 1001
joined in the year 1991.

mysql> select ename, deptno, hiredate
    -> from emp
    -> where deptno in(30,10) and year(hiredate) = 1981;
+--------+--------+------------+
| ename  | deptno | hiredate   |
+--------+--------+------------+
| ALLEN  |     30 | 1981-02-20 |
| WARD   |     30 | 1981-02-22 |
| MARTIN |     30 | 1981-09-28 |
| BLAKE  |     30 | 1981-05-01 |
| CLARK  |     10 | 1981-06-09 |
| KING   |     10 | 1981-11-17 |
| TURNER |     30 | 1981-09-08 |
| JAMES  |     30 | 1981-12-03 |
+--------+--------+------------+
8 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

37.Write a query in SQL to list the employees of department id 3001 or 1001
joined in the year 1991.

------------------------------------------------------------------------------------------------------------------------------

38.Write a query in SQL to list all the employees of designation CLERK in
department no 2001.

mysql> select ename, job, deptno
    -> from emp
    -> where job='clerk' and deptno = 20;
+-------+-------+--------+
| ename | job   | deptno |
+-------+-------+--------+
| SMITH | CLERK |     20 |
| ADAMS | CLERK |     20 |
+-------+-------+--------+
2 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

39.Write a query in SQL to list the ID, name, salary, and job_name of the
employees for -
1. Annual salary is below 34000 but receiving some commission which should
not be more than the salary,
2. And designation is SALESMAN and working for department 3001.

mysql> select empno,ename,sal,job,comm
    -> from emp
    -> where job="salesman" and deptno=30 and floor(sal*12) < 34000 and comm > sal;
+-------+--------+---------+----------+---------+
| empno | ename  | sal     | job      | comm    |
+-------+--------+---------+----------+---------+
|  7654 | MARTIN | 1250.00 | SALESMAN | 1400.00 |
+-------+--------+---------+----------+---------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

40.Write a query in SQL to list the employees who are either CLERK or
MANAGER.

mysql> select ename, job
    -> from emp
    -> where job in('clerk','manager');
+--------+---------+
| ename  | job     |
+--------+---------+
| SMITH  | CLERK   |
| JONES  | MANAGER |
| BLAKE  | MANAGER |
| CLARK  | MANAGER |
| ADAMS  | CLERK   |
| JAMES  | CLERK   |
| MILLER | CLERK   |
+--------+---------+
7 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

41.Write a query in SQL to list the employees who joined in any year except
the month February.

mysql> select ename, hiredate
    -> from emp
    -> where month(hiredate) != 2;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| SMITH  | 1980-12-17 |
| JONES  | 1981-04-02 |
| MARTIN | 1981-09-28 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| SCOTT  | 1982-12-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| ADAMS  | 1983-01-12 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
| MILLER | 1982-01-23 |
+--------+------------+
12 rows in set (0.00 sec)

mysql> select ename, hiredate
    -> from emp
    -> where monthname(hiredate) != 'February';
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| SMITH  | 1980-12-17 |
| JONES  | 1981-04-02 |
| MARTIN | 1981-09-28 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| SCOTT  | 1982-12-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| ADAMS  | 1983-01-12 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
| MILLER | 1982-01-23 |
+--------+------------+
12 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

42.Write a query in SQL to list the employees who joined in the year 91.

mysql> select ename, hiredate
    -> from emp
    -> where year(hiredate) = 1981;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| ALLEN  | 1981-02-20 |
| WARD   | 1981-02-22 |
| JONES  | 1981-04-02 |
| MARTIN | 1981-09-28 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
+--------+------------+
10 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

43.Write a query in SQL to list the employees who joined in the month of
June in 1981.

mysql> select ename, hiredate
    -> from emp
    -> where monthname(hiredate) = 'june' and year(hiredate) = 1981;
+-------+------------+
| ename | hiredate   |
+-------+------------+
| CLARK | 1981-06-09 |
+-------+------------+
1 row in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

44.Write a query in SQL to list the employees whose annual salary is within
the range 24000 and 50000.

mysql> select ename, sal, (sal*12)  as "Annual Sal"
    -> from emp
    -> where (sal*12) between 24000 and 50000;
+-------+---------+------------+
| ename | sal     | Annual Sal |
+-------+---------+------------+
| JONES | 2975.00 |   35700.00 |
| BLAKE | 2850.00 |   34200.00 |
| CLARK | 2450.00 |   29400.00 |
| SCOTT | 3000.00 |   36000.00 |
| FORD  | 3000.00 |   36000.00 |
+-------+---------+------------+
5 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

45.Write a query in SQL to list the employees who have joined on the
following dates 1st May,20th Feb, and 03rd Dec in the year 1991.

mysql> select ename, hiredate
    -> from emp
    -> where hiredate in (str_to_date('1st May 1981','%D %M %Y'),str_to_date('3rd Dec 1981','%D %M %Y'));
+-------+------------+
| ename | hiredate   |
+-------+------------+
| JAMES | 1981-12-03 |
| FORD  | 1981-12-03 |
+-------+------------+
2 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

46.Write a query in SQL to list the employees working under the managers
63679,68319,66564,69000.

mysql> select ename, mgr
    -> from emp
    -> where mgr in (7602,7698,7839,7782);
+--------+------+
| ename  | mgr  |
+--------+------+
| ALLEN  | 7698 |
| WARD   | 7698 |
| JONES  | 7839 |
| MARTIN | 7698 |
| BLAKE  | 7839 |
| CLARK  | 7839 |
| TURNER | 7698 |
| JAMES  | 7698 |
| MILLER | 7782 |
+--------+------+
9 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------

47.Write a query in SQL to list the employees who joined after the month
JUNE in the year 1992.

mysql> select ename, hiredate
    -> from emp
    -> where hiredate > str_to_date('01-06-1982','%d-%m-%Y');
+-------+------------+
| ename | hiredate   |
+-------+------------+
| SCOTT | 1982-12-09 |
| ADAMS | 1983-01-12 |
+-------+------------+
2 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

48.Write a query in SQL to list the employees who joined in 90's.

mysql> select ename, hiredate
    -> from emp
    -> where year(hiredate) between 1900 and 2000;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| SMITH  | 1980-12-17 |
| ALLEN  | 1981-02-20 |
| WARD   | 1981-02-22 |
| JONES  | 1981-04-02 |
| MARTIN | 1981-09-28 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| SCOTT  | 1982-12-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| ADAMS  | 1983-01-12 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
| MILLER | 1982-01-23 |
+--------+------------+
14 rows in set (0.00 sec)

mysql> select ename, hiredate
    -> from emp
    -> where year(hiredate) between 1980 and 1982;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| SMITH  | 1980-12-17 |
| ALLEN  | 1981-02-20 |
| WARD   | 1981-02-22 |
| JONES  | 1981-04-02 |
| MARTIN | 1981-09-28 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| SCOTT  | 1982-12-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
| MILLER | 1982-01-23 |
+--------+------------+
13 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

49.Write a query in SQL to list the managers of department 1001 or 2001.

mysql> select ename, job,deptno
    -> from emp
    -> where job = 'manager' and deptno in (20,10);
+-------+---------+--------+
| ename | job     | deptno |
+-------+---------+--------+
| JONES | MANAGER |     20 |
| CLARK | MANAGER |     10 |
+-------+---------+--------+
2 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

50.Write a query in SQL to list the employees, joined in the month
FEBRUARY with a salary range between 1001 to 2000.

mysql> select ename, hiredate, sal
    -> from emp
    -> where month(hiredate)=2 and sal between 1001 and 2000;
+-------+------------+---------+
| ename | hiredate   | sal     |
+-------+------------+---------+
| ALLEN | 1981-02-20 | 1600.00 |
| WARD  | 1981-02-22 | 1250.00 |
+-------+------------+---------+
2 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

51.Write a query in SQL to list all the employees who joined before or after
1991.

mysql> select ename, hiredate
    -> from emp
    -> where year(hiredate) > 1981 | year(hiredate) < 1981;
+--------+------------+
| ename  | hiredate   |
+--------+------------+
| SMITH  | 1980-12-17 |
| ALLEN  | 1981-02-20 |
| WARD   | 1981-02-22 |
| JONES  | 1981-04-02 |
| MARTIN | 1981-09-28 |
| BLAKE  | 1981-05-01 |
| CLARK  | 1981-06-09 |
| SCOTT  | 1982-12-09 |
| KING   | 1981-11-17 |
| TURNER | 1981-09-08 |
| ADAMS  | 1983-01-12 |
| JAMES  | 1981-12-03 |
| FORD   | 1981-12-03 |
| MILLER | 1982-01-23 |
+--------+------------+
14 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

52.Write a query in SQL to list the employees along with department name.

mysql> select emp.ename, emp.deptno, dept.dname from emp join dept on emp.deptno = dept.deptno;
+--------+--------+------------+
| ename  | deptno | dname      |
+--------+--------+------------+
| SMITH  |     20 | RESEARCH   |
| ALLEN  |     30 | SALES      |
| WARD   |     30 | SALES      |
| JONES  |     20 | RESEARCH   |
| MARTIN |     30 | SALES      |
| BLAKE  |     30 | SALES      |
| CLARK  |     10 | ACCOUNTING |
| SCOTT  |     20 | RESEARCH   |
| KING   |     10 | ACCOUNTING |
| TURNER |     30 | SALES      |
| ADAMS  |     20 | RESEARCH   |
| JAMES  |     30 | SALES      |
| FORD   |     20 | RESEARCH   |
| MILLER |     10 | ACCOUNTING |
+--------+--------+------------+
14 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

53. Write a query in SQL to list the name, job name, annual salary, department id, department name and grade of the employees who earn 60000 in a year or not working as an ANALYST. 

mysql> select ename,job,(sal*12) as "Annual Sal" ,emp.deptno,dname,grade
    ->      from emp join dept
    ->      on emp.deptno = dept.deptno
    ->      join salgrade
    ->      where (emp.sal*12) = 60000 and emp.job != 'analyst'
    -> and emp.sal between salgrade.losal and salgrade.hisal;
+-------+-----------+------------+--------+------------+-------+
| ename | job       | Annual Sal | deptno | dname      | grade |
+-------+-----------+------------+--------+------------+-------+
| KING  | PRESIDENT |   60000.00 |     10 | ACCOUNTING |     5 |
+-------+-----------+------------+--------+------------+-------+
1 row in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

54.Write a query in SQL to list the name, job name, manager id, salary, manager name, manager's salary for those 
employees whose salary is greater than the salary of their managers.

mysql> select e.ename as "Employee Name",e.job,e.mgr,e.sal,m.ename "Manager Name",m.sal "Manager Sal"
    -> from emp e, emp m
    -> where e.mgr = m.empno and e.sal > m.sal
    -> ;
+---------------+---------+------+---------+--------------+-------------+
| Employee Name | job     | mgr  | sal     | Manager Name | Manager Sal |
+---------------+---------+------+---------+--------------+-------------+
| SCOTT         | ANALYST | 7566 | 3000.00 | JONES        |     2975.00 |
| FORD          | ANALYST | 7566 | 3000.00 | JONES        |     2975.00 |
+---------------+---------+------+---------+--------------+-------------+
2 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

55.Write a query in SQL to list the employees name, department, salary and commission. For those whose salary is between 2000 and 5000 while location is PERTH.

mysql> select emp.ename, emp.deptno, emp.sal, emp.comm, dept.loc from emp join dept on emp.deptno = dept.deptno
    -> where emp.sal between 2000 and 5000 and dept.loc = 'new york'
    -> ;
+-------+--------+---------+------+----------+
| ename | deptno | sal     | comm | loc      |
+-------+--------+---------+------+----------+
| CLARK |     10 | 2450.00 | NULL | NEW YORK |
| KING  |     10 | 5000.00 | NULL | NEW YORK |
+-------+--------+---------+------+----------+
2 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

56.Write a query in SQL to list the grade, employee name for the department id 1001 or 3001 but salary grade is not 4 while they joined the company before 1992-12-31. 

mysql> select e.ename, s.grade
    -> from emp e, salgrade s
    -> where e.sal between s.losal and s.hisal
    -> and e.deptno in (10,20)
    -> and s.grade != 4
    -> and hiredate < str_to_date('1982-12-31','%Y-%m-%d')
    -> ;
+--------+-------+
| ename  | grade |
+--------+-------+
| SMITH  |     1 |
| MILLER |     2 |
| KING   |     5 |
+--------+-------+
3 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

57. Write a query in SQL to list the employees whose manager name is JONes

mysql> select * from emp where mgr = ( select empno from emp where ename = 'jones');
+-------+-------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+-------+---------+------+------------+---------+------+--------+
|  7788 | SCOTT | ANALYST | 7566 | 1982-12-09 | 3000.00 | NULL |     20 |
|  7902 | FORD  | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |
+-------+-------+---------+------+------------+---------+------+--------+
2 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

58.Write a query in SQL to list the name and salary of FRANK if his salary is equal to max_sal of his grade

mysql> select ename, sal
    -> from emp
    -> where ename='ford'
    -> and sal = ( select hisal from salgrade where grade = ( select grade from salgrade where losal < sal and hisal >= sal))
    -> ;
+-------+---------+
| ename | sal     |
+-------+---------+
| FORD  | 3000.00 |
+-------+---------+
1 row in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

59.Write a query in SQL to list the employees who are working either MANAGER or ANALYST with a salary range between 2000 to 5000 without any commission

mysql> select *
    -> from emp
    -> where job in ('analyst', 'manager')
    -> and sal between 2000 and 5000
    -> and comm is null
    -> ;
+-------+-------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+-------+---------+------+------------+---------+------+--------+
|  7566 | JONES | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL |     20 |
|  7698 | BLAKE | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |
|  7782 | CLARK | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL |     10 |
|  7788 | SCOTT | ANALYST | 7566 | 1982-12-09 | 3000.00 | NULL |     20 |
|  7902 | FORD  | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |
+-------+-------+---------+------+------------+---------+------+--------+
5 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

60. Write a query in SQL to list the id, name, salary, and location of the employees working at PERTH,or MELBOURNE with an experience over 10 years.

mysql> select emp.empno,emp.ename,emp.sal, dept.loc from emp join dept on emp.deptno = dept.deptno
    -> where dept.loc in ('new york','boston')
    -> and floor(datediff(curdate(),emp.hiredate)/365) > 10;
+-------+--------+---------+----------+
| empno | ename  | sal     | loc      |
+-------+--------+---------+----------+
|  7782 | CLARK  | 2450.00 | NEW YORK |
|  7839 | KING   | 5000.00 | NEW YORK |
|  7934 | MILLER | 1300.00 | NEW YORK |
+-------+--------+---------+----------+
3 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

61.Write a query in SQL to list the employees along with their location who belongs to SYDNEY, MELBOURNE with a salary range between 2000 and 5000 and joined in 1991.

mysql> select e.ename, dept.loc
    -> from emp e, dept
    -> where e.deptno = dept.deptno
    -> and dept.loc in ('New York','Boston')
    -> and e.sal between 2000 and 5000
    -> and date_format(hiredate,'%Y') = 1981;
+-------+----------+
| ename | loc      |
+-------+----------+
| CLARK | NEW YORK |
| KING  | NEW YORK |
+-------+----------+
2 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------

62.Write a query in SQL to list the employees with their location and grade for
MARKETING department who comes from MELBOURNE or PERTH within
the grade 3 to 5 and experience over 5 years.

mysql> select e.ename,d.loc,g.grade, floor(datediff(curdate(),e.hiredate)/365) as "XP"
    -> from emp e, dept d, salgrade g
    -> where e.deptno = d.deptno
    -> and e.sal between g.losal and g.hisal
    -> and d.loc in ('new york','boston','chicago')
    -> and g.grade between 3 and 5
    -> and floor(datediff(curdate(),e.hiredate)/365) > 5;
+--------+----------+-------+------+
| ename  | loc      | grade | XP   |
+--------+----------+-------+------+
| CLARK  | NEW YORK |     4 |   38 |
| KING   | NEW YORK |     5 |   37 |
| ALLEN  | CHICAGO  |     3 |   38 |
| BLAKE  | CHICAGO  |     4 |   38 |
| TURNER | CHICAGO  |     3 |   38 |
+--------+----------+-------+------+
5 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------

63.Write a query in SQL to list the employees who are senior to their own
manager.

mysql> select e.ename,e.hiredate,m.ename, m.hiredate as "MGR XP"
    -> from emp e, emp m
    -> where e.mgr = m.empno
    -> and floor(datediff(curdate(),e.hiredate)/365) > floor(datediff(curdate(),m.hiredate)/365)
    -> ;
+-------+------------+-------+------------+
| ename | hiredate   | ename | MGR XP     |
+-------+------------+-------+------------+
| JONES | 1981-04-02 | KING  | 1981-11-17 |
| BLAKE | 1981-05-01 | KING  | 1981-11-17 |
| CLARK | 1981-06-09 | KING  | 1981-11-17 |
| SMITH | 1980-12-17 | FORD  | 1981-12-03 |
+-------+------------+-------+------------+
4 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

64.Write a query in SQL to list the employee with their grade for the grade
4.

mysql> select e.ename, g.grade
    -> from emp e, salgrade g
    -> where e.sal between g.losal and g.hisal
    -> and g.grade = 4;
+-------+-------+
| ename | grade |
+-------+-------+
| JONES |     4 |
| BLAKE |     4 |
| CLARK |     4 |
| SCOTT |     4 |
| FORD  |     4 |
+-------+-------+
5 rows in set (0.00 sec)


------------------------------------------------------------------------------------------------------------------

65.Write a query in SQL to list the employees of grade 3 in department
PRODUCTION or AUDIT who joined after 1991 and they are not MARKER or
ADELYN to their name.

mysql> select e.ename, g.grade, d.dname
    -> from emp e, salgrade g, dept d
    -> where e.sal between g.losal and g.hisal
    -> and e.deptno = d.deptno
    -> and g.grade = 3
    -> and d.dname in ('research','sales')
    -> and year(hiredate) < 1981
    -> and e.ename not in('jones');
Empty set (0.00 sec)

mysql> select e.ename, g.grade, d.dname
    -> from emp e, salgrade g, dept d
    -> where e.sal between g.losal and g.hisal
    -> and e.deptno = d.deptno
    -> and g.grade = 3
    -> and d.dname in ('research','sales')
    -> and year(hiredate) < 1991
    -> and e.ename not in('jones');
+--------+-------+-------+
| ename  | grade | dname |
+--------+-------+-------+
| ALLEN  |     3 | SALES |
| TURNER |     3 | SALES |
+--------+-------+-------+
2 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------

66.Write a query in SQL to list the employees in the ascending order of their
salaries.

mysql> select *
    -> from emp
    -> order by sal;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------

67.Write a query in SQL to list the details of the employees in ascending
order to the department_id and descending order to the jobs.

mysql> select *
    -> from emp
    -> order by deptno,job desc;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------

68.Write a query in SQL to display all the unique job in descending order.


mysql> select distinct job
    -> from emp
    -> order by job desc;
+-----------+
| job       |
+-----------+
| SALESMAN  |
| PRESIDENT |
| MANAGER   |
| CLERK     |
| ANALYST   |
+-----------+
5 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

69. Write a query in SQL to list the id, name, monthly salary, daily salary of all
the employees in the ascending order of their annual salary.

mysql> select e.empno,e.ename,e.sal,floor(e.sal/31) as "Daily Sal", floor(e.sal*12) as "Annual Sal"
    -> from emp e
    -> order by floor(e.sal*12);
+-------+--------+---------+-----------+------------+
| empno | ename  | sal     | Daily Sal | Annual Sal |
+-------+--------+---------+-----------+------------+
|  7369 | SMITH  |  800.00 |        25 |       9600 |
|  7900 | JAMES  |  950.00 |        30 |      11400 |
|  7876 | ADAMS  | 1100.00 |        35 |      13200 |
|  7521 | WARD   | 1250.00 |        40 |      15000 |
|  7654 | MARTIN | 1250.00 |        40 |      15000 |
|  7934 | MILLER | 1300.00 |        41 |      15600 |
|  7844 | TURNER | 1500.00 |        48 |      18000 |
|  7499 | ALLEN  | 1600.00 |        51 |      19200 |
|  7782 | CLARK  | 2450.00 |        79 |      29400 |
|  7698 | BLAKE  | 2850.00 |        91 |      34200 |
|  7566 | JONES  | 2975.00 |        95 |      35700 |
|  7788 | SCOTT  | 3000.00 |        96 |      36000 |
|  7902 | FORD   | 3000.00 |        96 |      36000 |
|  7839 | KING   | 5000.00 |       161 |      60000 |
+-------+--------+---------+-----------+------------+
14 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------

70. Write a query in SQL to list the employees in descending order who are
either 'CLERK' or 'ANALYST'.

mysql> select *
    -> from emp
    -> where job in ('clerk','analyst')
    -> order by ename desc;
+-------+--------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME  | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+--------+---------+------+------------+---------+------+--------+
|  7369 | SMITH  | CLERK   | 7902 | 1980-12-17 |  800.00 | NULL |     20 |
|  7788 | SCOTT  | ANALYST | 7566 | 1982-12-09 | 3000.00 | NULL |     20 |
|  7934 | MILLER | CLERK   | 7782 | 1982-01-23 | 1300.00 | NULL |     10 |
|  7900 | JAMES  | CLERK   | 7698 | 1981-12-03 |  950.00 | NULL |     30 |
|  7902 | FORD   | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |
|  7876 | ADAMS  | CLERK   | 7788 | 1983-01-12 | 1100.00 | NULL |     20 |
+-------+--------+---------+------+------------+---------+------+--------+
6 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

71.Write a query in SQL to display the location of CLARE.

mysql> select e.empno,e.ename,dept.loc
    -> from emp e, dept
    -> where e.deptno=dept.deptno
    -> and e.ename = 'jones';
+-------+-------+--------+
| empno | ename | loc    |
+-------+-------+--------+
|  7566 | JONES | DALLAS |
+-------+-------+--------+
1 row in set (0.01 sec)


--------------------------------------------------------------------------------------------------------------------

72. Write a query in SQL to list the employees in ascending order of seniority
who joined on 1-MAY-91,or 3-DEC-91, or 19-JAN-90.

mysql> select *
    -> from emp
    -> where hiredate in ('1981-05-01','1981-12-03','1980-01-19')
    -> order by hiredate
    -> ;
+-------+-------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+-------+---------+------+------------+---------+------+--------+
|  7698 | BLAKE | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |
|  7900 | JAMES | CLERK   | 7698 | 1981-12-03 |  950.00 | NULL |     30 |
|  7902 | FORD  | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |
+-------+-------+---------+------+------------+---------+------+--------+
3 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

73.Write a query in SQL to list the employees who are drawing the salary less
than 1000 and sort the output in ascending order on salary.

mysql> select *
    -> from emp
    -> where sal < 1000
    -> order by sal
    -> ;
+-------+-------+-------+------+------------+--------+------+--------+
| EMPNO | ENAME | JOB   | MGR  | HIREDATE   | SAL    | COMM | DEPTNO |
+-------+-------+-------+------+------------+--------+------+--------+
|  7369 | SMITH | CLERK | 7902 | 1980-12-17 | 800.00 | NULL |     20 |
|  7900 | JAMES | CLERK | 7698 | 1981-12-03 | 950.00 | NULL |     30 |
+-------+-------+-------+------+------------+--------+------+--------+
2 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

74.Write a query in SQL to list the details of the employees in ascending
order on the salary.

mysql> select *
    -> from emp
    -> order by sal;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

75.Write a query in SQL to list the employees in ascending order on job name
and descending order on employee id.

mysql> select *
    -> from emp
    -> order by job, empno desc;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
+-------+--------+-----------+------+------------+---------+---------+--------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

76.Write a query in SQL to list the unique jobs of department 2001 and 3001
in descending order.

mysql> select distinct job, deptno
    -> from emp
    -> where deptno in (20,30)
    -> order by job desc;
+----------+--------+
| job      | deptno |
+----------+--------+
| SALESMAN |     30 |
| MANAGER  |     20 |
| MANAGER  |     30 |
| CLERK    |     20 |
| CLERK    |     30 |
| ANALYST  |     20 |
+----------+--------+
6 rows in set (0.00 sec)

mysql> select distinct job
    -> from emp
    -> where deptno=10
    -> union
    -> select distinct job
    -> from emp
    -> where deptno=20
    -> order by job desc;
+-----------+
| job       |
+-----------+
| PRESIDENT |
| MANAGER   |
| CLERK     |
| ANALYST   |
+-----------+
4 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

77.Write a query in SQL to list all the employees except PRESIDENT and
MANAGER in ascending order of salaries.

mysql> select *
    -> from emp
    -> where job not in ('president','manager')
    -> order by sal;
+-------+--------+----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK    | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK    | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7876 | ADAMS  | CLERK    | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7521 | WARD   | SALESMAN | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7934 | MILLER | CLERK    | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7499 | ALLEN  | SALESMAN | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7788 | SCOTT  | ANALYST  | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7902 | FORD   | ANALYST  | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
+-------+--------+----------+------+------------+---------+---------+--------+
10 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

78.Write a query in SQL to list the employees in ascending order of the salary
whose annual salary is below 25000.

mysql> select ename, job, sal, (sal*12) as "Annual Sal"
    -> from emp
    -> where (sal*12) < 25000
    -> order by sal asc;
+--------+----------+---------+------------+
| ename  | job      | sal     | Annual Sal |
+--------+----------+---------+------------+
| SMITH  | CLERK    |  800.00 |    9600.00 |
| JAMES  | CLERK    |  950.00 |   11400.00 |
| ADAMS  | CLERK    | 1100.00 |   13200.00 |
| WARD   | SALESMAN | 1250.00 |   15000.00 |
| MARTIN | SALESMAN | 1250.00 |   15000.00 |
| MILLER | CLERK    | 1300.00 |   15600.00 |
| TURNER | SALESMAN | 1500.00 |   18000.00 |
| ALLEN  | SALESMAN | 1600.00 |   19200.00 |
+--------+----------+---------+------------+
8 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

79.Write a query in SQL to list the employee id, name, annual salary, daily
salary of all the employees in the ascending order of annual salary who works
as a SALESMAN.

mysql> select empno, ename, (sal*12) "Annual Sal", sal
    -> from emp
    -> where job='salesman'
    -> order by (sal*12) asc;
+-------+--------+------------+---------+
| empno | ename  | Annual Sal | sal     |
+-------+--------+------------+---------+
|  7521 | WARD   |   15000.00 | 1250.00 |
|  7654 | MARTIN |   15000.00 | 1250.00 |
|  7844 | TURNER |   18000.00 | 1500.00 |
|  7499 | ALLEN  |   19200.00 | 1600.00 |
+-------+--------+------------+---------+
4 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

80.Write a query in SQL to list the employee id, name, hire_date, current date
and experience of the employees in ascending order on their experiences.

mysql> select empno,ename,hiredate,curdate() as "Current Date", floor(datediff(curdate(),hiredate)/365)
    -> from emp
    -> order by floor(datediff(curdate(),hiredate)/365)
    -> ;
+-------+--------+------------+--------------+-----------------------------------------+
| empno | ename  | hiredate   | Current Date | floor(datediff(curdate(),hiredate)/365) |
+-------+--------+------------+--------------+-----------------------------------------+
|  7788 | SCOTT  | 1982-12-09 | 2019-09-26   |                                      36 |
|  7876 | ADAMS  | 1983-01-12 | 2019-09-26   |                                      36 |
|  7839 | KING   | 1981-11-17 | 2019-09-26   |                                      37 |
|  7900 | JAMES  | 1981-12-03 | 2019-09-26   |                                      37 |
|  7902 | FORD   | 1981-12-03 | 2019-09-26   |                                      37 |
|  7934 | MILLER | 1982-01-23 | 2019-09-26   |                                      37 |
|  7369 | SMITH  | 1980-12-17 | 2019-09-26   |                                      38 |
|  7499 | ALLEN  | 1981-02-20 | 2019-09-26   |                                      38 |
|  7521 | WARD   | 1981-02-22 | 2019-09-26   |                                      38 |
|  7566 | JONES  | 1981-04-02 | 2019-09-26   |                                      38 |
|  7654 | MARTIN | 1981-09-28 | 2019-09-26   |                                      38 |
|  7698 | BLAKE  | 1981-05-01 | 2019-09-26   |                                      38 |
|  7782 | CLARK  | 1981-06-09 | 2019-09-26   |                                      38 |
|  7844 | TURNER | 1981-09-08 | 2019-09-26   |                                      38 |
+-------+--------+------------+--------------+-----------------------------------------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

81.Write a query in SQL to list the employees in ascending order of
designations of those, joined after the second half of 1991.

mysql> select *
    -> from emp
    -> where hiredate > '1981-06-01'
    -> order by job
    -> ;
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
+-------+--------+-----------+------+------------+---------+---------+--------+
9 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

82.Write a query in SQL to list the total information of employees table along
with department, and location of all the employees working under FINANCE
and AUDIT in the ascending department no.


mysql> select e.empno,e.ename,e.hiredate,e.job,e.mgr,e.sal,e.comm,e.deptno,d.dname,d.loc
    -> from emp e inner join dept d
    -> on e.deptno = d.deptno
    -> where e.deptno in (select deptno from dept where dname in ('accounting','sales'))
    -> order by e.deptno
    -> ;
+-------+--------+------------+-----------+------+---------+---------+--------+------------+----------+
| empno | ename  | hiredate   | job       | mgr  | sal     | comm    | deptno | dname      | loc      |
+-------+--------+------------+-----------+------+---------+---------+--------+------------+----------+
|  7934 | MILLER | 1982-01-23 | CLERK     | 7782 | 1300.00 |    NULL |     10 | ACCOUNTING | NEW YORK |
|  7782 | CLARK  | 1981-06-09 | MANAGER   | 7839 | 2450.00 |    NULL |     10 | ACCOUNTING | NEW YORK |
|  7839 | KING   | 1981-11-17 | PRESIDENT | NULL | 5000.00 |    NULL |     10 | ACCOUNTING | NEW YORK |
|  7499 | ALLEN  | 1981-02-20 | SALESMAN  | 7698 | 1600.00 |  300.00 |     30 | SALES      | CHICAGO  |
|  7521 | WARD   | 1981-02-22 | SALESMAN  | 7698 | 1250.00 |  500.00 |     30 | SALES      | CHICAGO  |
|  7654 | MARTIN | 1981-09-28 | SALESMAN  | 7698 | 1250.00 | 1400.00 |     30 | SALES      | CHICAGO  |
|  7698 | BLAKE  | 1981-05-01 | MANAGER   | 7839 | 2850.00 |    NULL |     30 | SALES      | CHICAGO  |
|  7844 | TURNER | 1981-09-08 | SALESMAN  | 7698 | 1500.00 |    0.00 |     30 | SALES      | CHICAGO  |
|  7900 | JAMES  | 1981-12-03 | CLERK     | 7698 |  950.00 |    NULL |     30 | SALES      | CHICAGO  |
+-------+--------+------------+-----------+------+---------+---------+--------+------------+----------+
9 rows in set (0.00 sec)


--------------------------------------------------------------------------------------------------------------------

83.Write a query in SQL to display the total information of the employees
along with grades in ascending order.

mysql> select*
    -> from emp e, salgrade g
    -> where e.sal between g.losal and g.hisal
    -> order by g.grade;
+-------+--------+-----------+------+------------+---------+---------+--------+-------+-------+-------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO | GRADE | LOSAL | HISAL |
+-------+--------+-----------+------+------------+---------+---------+--------+-------+-------+-------+
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |     1 |   700 |  1200 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |     1 |   700 |  1200 |
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |     1 |   700 |  1200 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |     2 |  1201 |  1400 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |     2 |  1201 |  1400 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |     2 |  1201 |  1400 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |     3 |  1401 |  2000 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |     3 |  1401 |  2000 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |     4 |  2001 |  3000 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |     4 |  2001 |  3000 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |     4 |  2001 |  3000 |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |     4 |  2001 |  3000 |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |     4 |  2001 |  3000 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |     5 |  3001 |  9999 |
+-------+--------+-----------+------+------------+---------+---------+--------+-------+-------+-------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

84.Write a query in SQL to list the name, job name, department, salary, and
grade of the employees according to the department in ascending order.

mysql> select e.ename, e.job, e.deptno, e.sal, g.grade
    -> from emp e inner join salgrade g
    -> where e.sal between g.losal and g.hisal
    -> order by e.deptno;
+--------+-----------+--------+---------+-------+
| ename  | job       | deptno | sal     | grade |
+--------+-----------+--------+---------+-------+
| MILLER | CLERK     |     10 | 1300.00 |     2 |
| CLARK  | MANAGER   |     10 | 2450.00 |     4 |
| KING   | PRESIDENT |     10 | 5000.00 |     5 |
| FORD   | ANALYST   |     20 | 3000.00 |     4 |
| SCOTT  | ANALYST   |     20 | 3000.00 |     4 |
| SMITH  | CLERK     |     20 |  800.00 |     1 |
| ADAMS  | CLERK     |     20 | 1100.00 |     1 |
| JONES  | MANAGER   |     20 | 2975.00 |     4 |
| MARTIN | SALESMAN  |     30 | 1250.00 |     2 |
| BLAKE  | MANAGER   |     30 | 2850.00 |     4 |
| ALLEN  | SALESMAN  |     30 | 1600.00 |     3 |
| TURNER | SALESMAN  |     30 | 1500.00 |     3 |
| WARD   | SALESMAN  |     30 | 1250.00 |     2 |
| JAMES  | CLERK     |     30 |  950.00 |     1 |
+--------+-----------+--------+---------+-------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

85. Write a query in SQL to list the name, job name, salary, grade and
department name of employees except CLERK and sort result set on the
basis of highest salary.

mysql> select e.ename, e.job, e.sal, g.grade , d.dname
    -> from emp e inner join salgrade g
    -> inner join dept d
    -> on e.deptno = d.deptno
    -> where e.sal between g.losal and g.hisal
    -> and e.job != 'clerk'
    -> order by sal desc;
+--------+-----------+---------+-------+------------+
| ename  | job       | sal     | grade | dname      |
+--------+-----------+---------+-------+------------+
| KING   | PRESIDENT | 5000.00 |     5 | ACCOUNTING |
| SCOTT  | ANALYST   | 3000.00 |     4 | RESEARCH   |
| FORD   | ANALYST   | 3000.00 |     4 | RESEARCH   |
| JONES  | MANAGER   | 2975.00 |     4 | RESEARCH   |
| BLAKE  | MANAGER   | 2850.00 |     4 | SALES      |
| CLARK  | MANAGER   | 2450.00 |     4 | ACCOUNTING |
| ALLEN  | SALESMAN  | 1600.00 |     3 | SALES      |
| TURNER | SALESMAN  | 1500.00 |     3 | SALES      |
| WARD   | SALESMAN  | 1250.00 |     2 | SALES      |
| MARTIN | SALESMAN  | 1250.00 |     2 | SALES      |
+--------+-----------+---------+-------+------------+
10 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

86.Write a query in SQL to list the employee ID, name, salary, department,
grade, experience, and annual salary of employees working for department
1001 or 2001.

mysql> select e.empno, e.ename, e.sal, e.deptno, g.grade , (timestampdiff(year,hiredate,curdate())) as xp, (e.sal*12) as "annual salary"
    -> from emp e, salgrade g
    -> where e.sal between g.losal and g.hisal
    -> and e.deptno in (10, 20);
+-------+--------+---------+--------+-------+------+---------------+
| empno | ename  | sal     | deptno | grade | xp   | annual salary |
+-------+--------+---------+--------+-------+------+---------------+
|  7369 | SMITH  |  800.00 |     20 |     1 |   38 |       9600.00 |
|  7876 | ADAMS  | 1100.00 |     20 |     1 |   36 |      13200.00 |
|  7934 | MILLER | 1300.00 |     10 |     2 |   37 |      15600.00 |
|  7566 | JONES  | 2975.00 |     20 |     4 |   38 |      35700.00 |
|  7782 | CLARK  | 2450.00 |     10 |     4 |   38 |      29400.00 |
|  7788 | SCOTT  | 3000.00 |     20 |     4 |   36 |      36000.00 |
|  7902 | FORD   | 3000.00 |     20 |     4 |   37 |      36000.00 |
|  7839 | KING   | 5000.00 |     10 |     5 |   37 |      60000.00 |
+-------+--------+---------+--------+-------+------+---------------+
8 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

87.Write a query in SQL to list the details of the employees along with the
details of their departments.

mysql> select *
    -> from emp e, dept d
    -> where e.deptno = d.deptno
    -> ;
+-------+--------+-----------+------+------------+---------+---------+--------+--------+------------+----------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO | DEPTNO | DNAME      | LOC      |
+-------+--------+-----------+------+------------+---------+---------+--------+--------+------------+----------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |     20 | RESEARCH   | DALLAS   |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |     30 | SALES      | CHICAGO  |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |     30 | SALES      | CHICAGO  |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |     20 | RESEARCH   | DALLAS   |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |     30 | SALES      | CHICAGO  |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |     30 | SALES      | CHICAGO  |
|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |     10 | ACCOUNTING | NEW YORK |
|  7788 | SCOTT  | ANALYST   | 7566 | 1982-12-09 | 3000.00 |    NULL |     20 |     20 | RESEARCH   | DALLAS   |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |     10 | ACCOUNTING | NEW YORK |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |     30 | SALES      | CHICAGO  |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |     20 | RESEARCH   | DALLAS   |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |     30 | SALES      | CHICAGO  |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |     20 | RESEARCH   | DALLAS   |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |     10 | ACCOUNTING | NEW YORK |
+-------+--------+-----------+------+------------+---------+---------+--------+--------+------------+----------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

88.Write a query in SQL to list the employees who are senior to their own
MANAGERS.

mysql> select e.ename,e.hiredate,m.ename, m.hiredate as "MGR XP"
    -> from emp e, emp m
    -> where e.mgr = m.empno
    -> and floor(datediff(curdate(),e.hiredate)/365) > floor(datediff(curdate(),m.hiredate)/365)
    -> ;
+-------+------------+-------+------------+
| ename | hiredate   | ename | MGR XP     |
+-------+------------+-------+------------+
| JONES | 1981-04-02 | KING  | 1981-11-17 |
| BLAKE | 1981-05-01 | KING  | 1981-11-17 |
| CLARK | 1981-06-09 | KING  | 1981-11-17 |
| SMITH | 1980-12-17 | FORD  | 1981-12-03 |
+-------+------------+-------+------------+
4 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

89.Write a query in SQL to list the employee id, name, salary, and
department id of the employees in ascending order of salary who works in the
department 1001.

mysql> select e.empno, e.ename, e.sal, e.deptno
    -> from emp e
    -> where e.deptno = 10
    -> order by e.sal asc;
+-------+--------+---------+--------+
| empno | ename  | sal     | deptno |
+-------+--------+---------+--------+
|  7934 | MILLER | 1300.00 |     10 |
|  7782 | CLARK  | 2450.00 |     10 |
|  7839 | KING   | 5000.00 |     10 |
+-------+--------+---------+--------+
3 rows in set (0.00 sec)


--------------------------------------------------------------------------------------------------------------------

90.Write a query in SQL to find the highest salary from all the employees.

mysql> select ename, max(sal)
    -> from emp;
+-------+----------+
| ename | max(sal) |
+-------+----------+
| SMITH |  5000.00 |
+-------+----------+
1 row in set (0.01 sec)

--------------------------------------------------------------------------------------------------------------------

91.Write a query in SQL to find the average salary and average total
remuneration(salary and commission) for each type of job.

mysql> select job, round(avg(sal),2) "AVG sal", round(avg(sal*comm),2)
    -> from emp
    -> group by job;
+-----------+---------+------------------------+
| job       | AVG sal | round(avg(sal*comm),2) |
+-----------+---------+------------------------+
| CLERK     | 1037.50 |                   NULL |
| SALESMAN  | 1400.00 |              713750.00 |
| MANAGER   | 2758.33 |                   NULL |
| ANALYST   | 3000.00 |                   NULL |
| PRESIDENT | 5000.00 |                   NULL |
+-----------+---------+------------------------+
5 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

92.Write a query in SQL to find the total annual salary distributed against
each job in the year 1991.

mysql> select job, round(avg(sal*12),2), hiredate
    -> from emp
    -> where year(hiredate) = 1981
    -> group by job;
+-----------+----------------------+------------+
| job       | round(avg(sal*12),2) | hiredate   |
+-----------+----------------------+------------+
| SALESMAN  |             16800.00 | 1981-02-20 |
| MANAGER   |             33100.00 | 1981-04-02 |
| PRESIDENT |             60000.00 | 1981-11-17 |
| CLERK     |             11400.00 | 1981-12-03 |
| ANALYST   |             36000.00 | 1981-12-03 |
+-----------+----------------------+------------+
5 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

93.Write a query in SQL to list the employee id, name, department id, location
of all the employees.

mysql> select e.empno, e.ename, e.deptno, d.loc
    -> from emp e, dept d
    -> where e.deptno = d.deptno;
+-------+--------+--------+----------+
| empno | ename  | deptno | loc      |
+-------+--------+--------+----------+
|  7369 | SMITH  |     20 | DALLAS   |
|  7499 | ALLEN  |     30 | CHICAGO  |
|  7521 | WARD   |     30 | CHICAGO  |
|  7566 | JONES  |     20 | DALLAS   |
|  7654 | MARTIN |     30 | CHICAGO  |
|  7698 | BLAKE  |     30 | CHICAGO  |
|  7782 | CLARK  |     10 | NEW YORK |
|  7788 | SCOTT  |     20 | DALLAS   |
|  7839 | KING   |     10 | NEW YORK |
|  7844 | TURNER |     30 | CHICAGO  |
|  7876 | ADAMS  |     20 | DALLAS   |
|  7900 | JAMES  |     30 | CHICAGO  |
|  7902 | FORD   |     20 | DALLAS   |
|  7934 | MILLER |     10 | NEW YORK |
+-------+--------+--------+----------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

94.Write a query in SQL to list the employee id, name, location, department of
all the departments 1001 and 2001.

mysql> select e.empno, e.ename, d.loc, e.deptno
    -> from emp e, dept d
    -> where e.deptno = d.deptno
    -> and e.deptno in (10,20);
+-------+--------+----------+--------+
| empno | ename  | loc      | deptno |
+-------+--------+----------+--------+
|  7782 | CLARK  | NEW YORK |     10 |
|  7839 | KING   | NEW YORK |     10 |
|  7934 | MILLER | NEW YORK |     10 |
|  7369 | SMITH  | DALLAS   |     20 |
|  7566 | JONES  | DALLAS   |     20 |
|  7788 | SCOTT  | DALLAS   |     20 |
|  7876 | ADAMS  | DALLAS   |     20 |
|  7902 | FORD   | DALLAS   |     20 |
+-------+--------+----------+--------+
8 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

95.Write a query in SQL to list the employee id, name, location, department of
all the departments 1001 and 2001.

mysql> select e.empno, e.ename, d.loc, e.deptno
    -> from emp e, dept d
    -> where e.deptno = d.deptno
    -> and e.deptno in (10,20);
+-------+--------+----------+--------+
| empno | ename  | loc      | deptno |
+-------+--------+----------+--------+
|  7782 | CLARK  | NEW YORK |     10 |
|  7839 | KING   | NEW YORK |     10 |
|  7934 | MILLER | NEW YORK |     10 |
|  7369 | SMITH  | DALLAS   |     20 |
|  7566 | JONES  | DALLAS   |     20 |
|  7788 | SCOTT  | DALLAS   |     20 |
|  7876 | ADAMS  | DALLAS   |     20 |
|  7902 | FORD   | DALLAS   |     20 |
+-------+--------+----------+--------+
8 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

96.Write a query in SQL to list the manager no and the number of employees
working for those managers in ascending order on manager id.

mysql> select e.mgr, count(*)
    -> from emp e, emp m
    -> where e.mgr = m.empno
    -> group by e.mgr
    -> order by e.mgr
    -> ;
+------+----------+
| mgr  | count(*) |
+------+----------+
| 7566 |        2 |
| 7698 |        5 |
| 7782 |        1 |
| 7788 |        1 |
| 7839 |        3 |
| 7902 |        1 |
+------+----------+
6 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

97.Write a query in SQL to display the number of employee for each job in
each department.

mysql> select deptno, job, count(*)
    -> from emp
    -> group by deptno, job
    -> order by deptno;
+--------+-----------+----------+
| deptno | job       | count(*) |
+--------+-----------+----------+
|     10 | CLERK     |        1 |
|     10 | MANAGER   |        1 |
|     10 | PRESIDENT |        1 |
|     20 | ANALYST   |        2 |
|     20 | CLERK     |        2 |
|     20 | MANAGER   |        1 |
|     30 | CLERK     |        1 |
|     30 | MANAGER   |        1 |
|     30 | SALESMAN  |        4 |
+--------+-----------+----------+
9 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

98.Write a query in SQL to list the department where at least two employees
are working.

mysql> select deptno, count(*)
    -> from emp
    -> group by deptno, job
    -> having count(*) > 1;
+--------+----------+
| deptno | count(*) |
+--------+----------+
|     20 |        2 |
|     30 |        4 |
|     20 |        2 |
+--------+----------+
3 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

99.Write a query in SQL to display the Grade, Number of employees, and
maximum salary of each grade.

mysql> select g.grade, count(*), max(e.sal)
    -> from emp e, salgrade g
    -> where e.sal between g.losal and g.hisal
    -> group by g.grade
    -> ;
+-------+----------+------------+
| grade | count(*) | max(e.sal) |
+-------+----------+------------+
|     1 |        3 |    1100.00 |
|     3 |        2 |    1600.00 |
|     2 |        3 |    1300.00 |
|     4 |        5 |    3000.00 |
|     5 |        1 |    5000.00 |
+-------+----------+------------+
5 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

100.Write a query in SQL to display the department name, grade, no. of
employees where at least two employees are working as a SALESMAN.

mysql> select d.dname, g.grade, count(*), e.job
    -> from emp e, dept d, salgrade g
    -> where e.deptno = d.deptno
    -> and e.job = 'salesman'
    -> and e.sal between g.losal and g.hisal
    -> group by e.deptno, g.grade
    -> having count(*) > 1;
+-------+-------+----------+----------+
| dname | grade | count(*) | job      |
+-------+-------+----------+----------+
| SALES |     2 |        2 | SALESMAN |
| SALES |     3 |        2 | SALESMAN |
+-------+-------+----------+----------+
2 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

101.Write a query in SQL to list the no. of employees in each department
where the no. is less than 4.

mysql> select count(*) , deptno
    -> from emp
    -> group by deptno
    -> having count(*) < 4;
+----------+--------+
| count(*) | deptno |
+----------+--------+
|        3 |     10 |
+----------+--------+
1 row in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

102.Write a query in SQL to list the name of departments where atleast 2
employees are working in that department.

mysql> select e.deptno, d.dname, count(*)
    -> from emp e , dept d
    -> where e.deptno = d.deptno
    -> group by e.deptno
    -> having count(empno) > 1;
+--------+------------+----------+
| deptno | dname      | count(*) |
+--------+------------+----------+
|     20 | RESEARCH   |        5 |
|     30 | SALES      |        6 |
|     10 | ACCOUNTING |        3 |
+--------+------------+----------+
3 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

103.Write a query in SQL to check whether all the employees numbers are
indeed unique.

mysql> select distinct empno
    -> from emp;
+-------+
| empno |
+-------+
|  7369 |
|  7499 |
|  7521 |
|  7566 |
|  7654 |
|  7698 |
|  7782 |
|  7788 |
|  7839 |
|  7844 |
|  7876 |
|  7900 |
|  7902 |
|  7934 |
+-------+
14 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

104.Write a query in SQL to list the no. of employees and average salary
within each department for each job name.

mysql> select count(*), avg(sal), deptno, job
    -> from emp
    -> group by deptno, job;
+----------+-------------+--------+-----------+
| count(*) | avg(sal)    | deptno | job       |
+----------+-------------+--------+-----------+
|        2 |  950.000000 |     20 | CLERK     |
|        4 | 1400.000000 |     30 | SALESMAN  |
|        1 | 2975.000000 |     20 | MANAGER   |
|        1 | 2850.000000 |     30 | MANAGER   |
|        1 | 2450.000000 |     10 | MANAGER   |
|        2 | 3000.000000 |     20 | ANALYST   |
|        1 | 5000.000000 |     10 | PRESIDENT |
|        1 |  950.000000 |     30 | CLERK     |
|        1 | 1300.000000 |     10 | CLERK     |
+----------+-------------+--------+-----------+
9 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

105. Write a query in SQL to list the names of those employees starting with
'A' and with six characters in length.

mysql> select *
    -> from emp
    -> where ename regexp('^A....$');
+-------+-------+----------+------+------------+---------+--------+--------+
| EMPNO | ENAME | JOB      | MGR  | HIREDATE   | SAL     | COMM   | DEPTNO |
+-------+-------+----------+------+------------+---------+--------+--------+
|  7499 | ALLEN | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 |     30 |
|  7876 | ADAMS | CLERK    | 7788 | 1983-01-12 | 1100.00 |   NULL |     20 |
+-------+-------+----------+------+------------+---------+--------+--------+
2 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

106. Write a query in SQL to list the employees whose name is six characters
in length and third character must be 'R'.

mysql> select *
    -> from emp
    -> where ename regexp('^..R...$');
+-------+--------+----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+----------+------+------------+---------+---------+--------+
|  7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7844 | TURNER | SALESMAN | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
+-------+--------+----------+------+------------+---------+---------+--------+
2 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

107. Write a query in SQL to list the name of the employee of six characters
long and starting with 'A' and ending with 'N'.

mysql> select *
    -> from emp
    -> where ename regexp ('^A...N$');
+-------+-------+----------+------+------------+---------+--------+--------+
| EMPNO | ENAME | JOB      | MGR  | HIREDATE   | SAL     | COMM   | DEPTNO |
+-------+-------+----------+------+------------+---------+--------+--------+
|  7499 | ALLEN | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 |     30 |
+-------+-------+----------+------+------------+---------+--------+--------+
1 row in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

108. Write a query in SQL to list the employees who joined in the month of
which second character is 'a'.

mysql> select *
    -> from emp
    -> where date_format(hiredate,'%M') regexp ('^.A');
+-------+--------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME  | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+--------+---------+------+------------+---------+------+--------+
|  7698 | BLAKE  | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |
|  7876 | ADAMS  | CLERK   | 7788 | 1983-01-12 | 1100.00 | NULL |     20 |
|  7934 | MILLER | CLERK   | 7782 | 1982-01-23 | 1300.00 | NULL |     10 |
+-------+--------+---------+------+------------+---------+------+--------+
3 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

109. Write a query in SQL to list the employees whose names containing the
character set 'AR' together.

mysql> select *
    -> from emp
    -> where ename regexp ('AR');
+-------+--------+----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+----------+------+------------+---------+---------+--------+
|  7521 | WARD   | SALESMAN | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7782 | CLARK  | MANAGER  | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
+-------+--------+----------+------+------------+---------+---------+--------+
3 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

110. Write a query in SQL to list the employees those who joined in 90's.

mysql> select *
    -> from emp
    -> where year(hiredate) = 1980;
+-------+-------+-------+------+------------+--------+------+--------+
| EMPNO | ENAME | JOB   | MGR  | HIREDATE   | SAL    | COMM | DEPTNO |
+-------+-------+-------+------+------------+--------+------+--------+
|  7369 | SMITH | CLERK | 7902 | 1980-12-17 | 800.00 | NULL |     20 |
+-------+-------+-------+------+------------+--------+------+--------+
1 row in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

111. Write a query in SQL to list the employees whose ID not starting with
digit 77.

mysql> select *
    -> from emp
    -> where empno not regexp '^77';
+-------+--------+-----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+-----------+------+------------+---------+---------+--------+
|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |
|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |
|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |
|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |
|  7876 | ADAMS  | CLERK     | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |
|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |
+-------+--------+-----------+------+------------+---------+---------+--------+
12 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

112. Write a query in SQL to list the employees whose names containing the
letter 'A'.

mysql> select *
    -> from emp
    -> where ename regexp('A');
+-------+--------+----------+------+------------+---------+---------+--------+
| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
+-------+--------+----------+------+------------+---------+---------+--------+
|  7499 | ALLEN  | SALESMAN | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |
|  7521 | WARD   | SALESMAN | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |
|  7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |
|  7698 | BLAKE  | MANAGER  | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |
|  7782 | CLARK  | MANAGER  | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |
|  7876 | ADAMS  | CLERK    | 7788 | 1983-01-12 | 1100.00 |    NULL |     20 |
|  7900 | JAMES  | CLERK    | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |
+-------+--------+----------+------+------------+---------+---------+--------+
7 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

113. Write a query in SQL to list the employees whose name is ending with 'S'
and six characters long.

mysql> select *
    -> from emp
    -> where ename regexp('....s$');
+-------+-------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+-------+---------+------+------------+---------+------+--------+
|  7566 | JONES | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL |     20 |
|  7876 | ADAMS | CLERK   | 7788 | 1983-01-12 | 1100.00 | NULL |     20 |
|  7900 | JAMES | CLERK   | 7698 | 1981-12-03 |  950.00 | NULL |     30 |
+-------+-------+---------+------+------------+---------+------+--------+
3 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

114. Write a query in SQL to list the employees who joined in the month
having char 'A' at any position.

mysql> select *
    -> from emp
    -> where date_format(hiredate,'%M') regexp ('A');
+-------+--------+----------+------+------------+---------+--------+--------+
| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM   | DEPTNO |
+-------+--------+----------+------+------------+---------+--------+--------+
|  7499 | ALLEN  | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 |     30 |
|  7521 | WARD   | SALESMAN | 7698 | 1981-02-22 | 1250.00 | 500.00 |     30 |
|  7566 | JONES  | MANAGER  | 7839 | 1981-04-02 | 2975.00 |   NULL |     20 |
|  7698 | BLAKE  | MANAGER  | 7839 | 1981-05-01 | 2850.00 |   NULL |     30 |
|  7876 | ADAMS  | CLERK    | 7788 | 1983-01-12 | 1100.00 |   NULL |     20 |
|  7934 | MILLER | CLERK    | 7782 | 1982-01-23 | 1300.00 |   NULL |     10 |
+-------+--------+----------+------+------------+---------+--------+--------+
6 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------

115. Write a query in SQL to list the employees who joined in the month
having second char is 'A'.

mysql> select *
    -> from emp
    -> where date_format(hiredate,'%M') regexp ('^.A');
+-------+--------+---------+------+------------+---------+------+--------+
| EMPNO | ENAME  | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |
+-------+--------+---------+------+------------+---------+------+--------+
|  7698 | BLAKE  | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |
|  7876 | ADAMS  | CLERK   | 7788 | 1983-01-12 | 1100.00 | NULL |     20 |
|  7934 | MILLER | CLERK   | 7782 | 1982-01-23 | 1300.00 | NULL |     10 |
+-------+--------+---------+------+------------+---------+------+--------+
3 rows in set (0.00 sec)